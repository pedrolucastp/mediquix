import{u as e}from"./SelectorsComponent-kxMDd0Sf.js";import{u as o,G as l}from"./GameContainer-Cx9z9Rey.js";import{_ as a,r,x as t,c as n,a as s,d as u,f as i,e as c,g as d,h as f,i as v,n as h,F as w,j as g,k as p,t as m,p as b,B as y,q as k}from"./index-DCpJmo-T.js";const C={class:"crosswords-game"},x={id:"crossword-container"},$={key:0,class:"clue-number"},I=["id","data-row","data-col","data-correct","data-words","onClick"],B={id:"clues"},M=["onClick","title"],S={key:0,class:"loading-overlay"},T={class:"loading-message"},_=25,N=30,E=a({__name:"CrosswordsGame",setup(a){const{usePerk:E}=o(),F=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#ff24c0","#D4A5A5","#9B97B2","#FFB347","#87CEEB","#98FB98"],z=Math.floor(12.5),j=Math.floor(15),A=r([]),J=r([]),O=r(null),P=r("across"),R=r(new Set),D=r(new Set),G=r(null),U=t({}),q=r(!1),H=r(1),L=r(!1),W=r(0),V=e(),K=r(!0),Q=r({row:null,col:null,wordIndex:0}),X=n((()=>({gridTemplateColumns:"repeat(30, 40px)",gridTemplateRows:"repeat(25, 40px)"}))),Y=n((()=>Array.from({length:_},((e,o)=>o)))),Z=n((()=>Array.from({length:N},((e,o)=>o))));function ee(e,o){var l;return(null==(l=A.value[e])?void 0:l[o])||null}function oe(e,o){const l=J.value.filter((l=>l.positions.some((l=>l.row===e&&l.col===o))));return JSON.stringify(l.map((e=>({wordNumber:e.number,direction:e.direction}))))}function le(e,o){const l=J.value.filter((l=>l.positions.some((l=>l.row===e&&l.col===o))));return l.length>0?" "===ee(e,o)?"white":l[0].color+(function(e,o){return R.value.has(`${e}-${o}`)}(e,o)||function(e,o){return D.value.has(`${e}-${o}`)}(e,o)?"":"70"):"transparent"}function ae(e,o){const l=J.value.filter((l=>l.positions.some((l=>l.row===e&&l.col===o))));if(0===l.length)return{};const a={border:"1px solid var(--dark-border-color)",backgroundColor:"transparent"},r=l.find((e=>e.positions.some((e=>R.value.has(`${e.row}-${e.col}`)))));if(r){a.backgroundColor="rgba(255, 255, 0, 0.1)";const l=r.positions.findIndex((l=>l.row===e&&l.col===o)),t=0===l,n=l===r.positions.length-1;"across"===r.direction?(a.borderTop="3px solid darkgrey",a.borderBottom="3px solid darkgrey",t&&(a.borderLeft="3px solid darkgrey"),n&&(a.borderRight="3px solid darkgrey")):(a.borderLeft="3px solid darkgrey",a.borderRight="3px solid darkgrey",t&&(a.borderTop="3px solid darkgrey"),n&&(a.borderBottom="3px solid darkgrey"))}return a}function re(e,o){return J.value.some((l=>l.row===e&&l.col===o))}function te(e,o){const l=J.value.find((l=>l.row===e&&l.col===o));return null==l?void 0:l.number}function ne(e){se(),e.positions.forEach((e=>{R.value.add(`${e.row}-${e.col}`)})),G.value=e.number}function se(){R.value.clear(),D.value.clear(),G.value=null}function ue(e){const o=e.target,l=JSON.parse(o.dataset.words||"[]");if(l&&l.length>0&&(!O.value||!ie(o))){O.value=l[0],P.value=l[0].direction;const e=J.value.find((e=>e.number===l[0].wordNumber));e&&ne(e)}if(!e.data||""===o.value)return o.value="",void function(e){const o=parseInt(e.dataset.row),l=parseInt(e.dataset.col);if(!O.value||!P.value)return;let a=o,r=l;"across"===P.value?r--:a--;const t=U[`${a}-${r}`];t&&ie(t)&&(t.focus(),t.select())}(o);o.value=e.data.toUpperCase(),o.select(),function(e){const o=parseInt(e.dataset.row),l=parseInt(e.dataset.col);if(!O.value||!P.value)return;let a=o,r=l;"across"===P.value?r++:a++;const t=U[`${a}-${r}`];t&&ie(t)&&t.focus()}(o)}function ie(e){if(!O.value||!P.value)return!1;const o=JSON.parse(e.dataset.words||"[]");if(!o||0===o.length)return!1;const l=J.value.find((e=>e.number===O.value.wordNumber));if(!l)return!1;const a=parseInt(e.dataset.row),r=parseInt(e.dataset.col);return"across"===P.value?a===l.row&&r>=l.col&&r<l.col+l.word.length:r===l.col&&a>=l.row&&a<l.row+l.word.length}function ce(e,o,l,a){if("across"===a){if(l<0||l+e.length>N||o<0||o>=_)return!1;let a=!1;for(let n=0;n<e.length;n++){const r=A.value[o][l+n];if(r){if(r!==e[n])return!1;a=!0}const t=o>0?A.value[o-1][l+n]:null,s=o<24?A.value[o+1][l+n]:null;if(t&&!de(o-1,l+n)||s&&!de(o+1,l+n))return!1}const r=l>0?A.value[o][l-1]:null,t=l+e.length<N?A.value[o][l+e.length]:null;return!r&&!t&&(0===J.value.length||a)}if("down"===a){if(o<0||o+e.length>_||l<0||l>=N)return!1;let a=!1;for(let n=0;n<e.length;n++){const r=A.value[o+n][l];if(r){if(r!==e[n])return!1;a=!0}const t=l>0?A.value[o+n][l-1]:null,s=l<29?A.value[o+n][l+1]:null;if(t&&!de(o+n,l-1)||s&&!de(o+n,l+1))return!1}const r=o>0?A.value[o-1][l]:null,t=o+e.length<_?A.value[o+e.length][l]:null;return!r&&!t&&(0===J.value.length||a)}return!1}function de(e,o){return J.value.some((l=>"across"===l.direction?e===l.row&&o>=l.col&&o<l.col+l.word.length:"down"===l.direction&&(o===l.col&&e>=l.row&&e<l.row+l.word.length)))}async function fe(e,o,l,a,r=!0){const t=[];if("across"===a)for(let n=0;n<e.length;n++)null===A.value[o][l+n]&&(A.value[o][l+n]=r?"?":e[n],t.push({row:o,col:l+n}));else for(let n=0;n<e.length;n++)null===A.value[o+n][l]&&(A.value[o+n][l]=r?"?":e[n],t.push({row:o+n,col:l}));return r&&(await async function(e){return new Promise((o=>setTimeout(o,e)))}(20),t.forEach((e=>{"?"===A.value[e.row][e.col]&&(A.value[e.row][e.col]=null)}))),t}function ve(e,o,l,a){let r=0;if("across"===a)for(let t=0;t<e.length;t++)null!==A.value[o][l+t]&&A.value[o][l+t]===e[t]&&r++;else for(let t=0;t<e.length;t++)null!==A.value[o+t][l]&&A.value[o+t][l]===e[t]&&r++;return r}function he(e,o){const l=[];for(let a=0;a<_;a++)for(let r=0;r<N;r++)if(ce(e,a,r,o)){const t=ve(e,a,r,o);l.push({row:a,col:r,direction:o,intersections:t})}return l.sort(((e,o)=>o.intersections-e.intersections)),l}async function we(e){for(;J.value.length<5;){let o=!1;const l=new Set;for(;!o&&l.size<e.length;){let a;do{a=Math.floor(Math.random()*e.length)}while(l.has(a));l.add(a);const r=e[a],t=[];for(const e of["across","down"]){const o=await he(r.word,e);t.push(...o)}if(t.length>0){t.sort(((e,o)=>o.intersections-e.intersections));const l=t.slice(0,Math.min(3,t.length)),n=l[Math.floor(Math.random()*l.length)];await fe(r.word,n.row,n.col,n.direction,!0);const s=await fe(r.word,n.row,n.col,n.direction,!1);if(s.length>0){J.value.push({word:r.word,clue:r.clue,row:n.row,col:n.col,direction:n.direction,positions:s,number:J.value.length+1,color:F[J.value.length%F.length]}),e.splice(a,1),o=!0;break}}}if(!o)return!1}return 5===J.value.length}async function ge(e){if(H.value>5)return!1;!function(){A.value=[];for(let e=0;e<_;e++)A.value.push(new Array(N).fill(null));for(const e in U){const o=U[e];o&&(o.value="",o.style.backgroundColor="transparent",o.style.color="var(--text-color)")}J.value=[],se(),O.value=null,P.value="across",A.value.forEach((e=>e.fill(null)))}(),setTimeout((()=>function(){const e=document.getElementById("crossword");if(e){const o=(e.scrollWidth-e.clientWidth)/2,l=(e.scrollHeight-e.clientHeight)/2;e.scrollTo({left:o,top:l,behavior:"smooth"})}}()),100);const o=[...e],l=new Set;for(;l.size<o.length;){let e;do{e=Math.floor(Math.random()*o.length)}while(l.has(e));l.add(e);const a=o[e],r=await fe(a.word,z,Math.floor(j-a.word.length/2),"across",!1);if(r.length>0){J.value.push({word:a.word,clue:a.clue,row:z,col:Math.floor(j-a.word.length/2),direction:"across",positions:r,number:1,color:F[0]}),o.splice(e,1);if(await we(o))return!0}}return H.value++,!1}async function pe(e=!1){if(e||K.value)try{q.value=!0,L.value=!0;const e=V.filteredWords;!(await ge(e))&&H.value<5&&await pe(!0)}catch(o){}finally{q.value=!1,L.value=!1,se(),K.value=!1}}async function me(e){if(await E(e)&&"hint"===e){const e=Object.values(U).filter((e=>e&&""===e.value));if(e.length>0){const o=e[Math.floor(Math.random()*e.length)];o.value=o.dataset.correct,o.style.backgroundColor="#ffe066",setTimeout((()=>{o.style.backgroundColor=""}),1e3)}}}function be(){for(const e in U){const o=U[e];o&&o.dataset.correct&&(o.value=o.dataset.correct,o.style.color="#FF0000")}W.value=0}return s((()=>{pe()})),(e,o)=>(c(),u(l,{title:"Palavras Cruzadas",gameInstructions:"Complete as palavras cruzadas usando as dicas fornecidas.\n- Clique em uma célula para selecionar uma palavra\n- Use as dicas para descobrir as palavras\n- Clique em uma dica para destacar a palavra correspondente\n- Use a dica (perk) para revelar uma letra aleatória\n- Todas as palavras estão relacionadas à especialidade médica selecionada",loading:L.value,score:W.value,availablePerks:["hint","extra_time","skip"],onSpecialtyChange:o[1]||(o[1]=e=>pe(!0)),onDifficultyChange:o[2]||(o[2]=e=>pe(!0)),onUsePerk:me},{"game-settings":i((()=>[b(y,{onClick:o[0]||(o[0]=e=>pe(!0))},{default:i((()=>o[3]||(o[3]=[k("Novo Jogo")]))),_:1}),b(y,{onClick:be,variant:"accent"},{default:i((()=>o[4]||(o[4]=[k("Revelar Respostas")]))),_:1})])),default:i((()=>[d("div",C,[d("div",x,[d("div",{id:"crossword",style:h(X.value)},[(c(!0),f(w,null,g(Y.value,(e=>(c(),f(w,{key:e},[(c(!0),f(w,null,g(Z.value,(o=>(c(),f("div",{key:`${e}-${o}`,class:p(["cell",{empty:!ee(e,o)}]),style:h(ee(e,o)?ae(e,o):{})},[ee(e,o)?(c(),f(w,{key:0},[re(e,o)?(c(),f("span",$,m(te(e,o)),1)):v("",!0),d("input",{id:`cell-${e}-${o}`,ref_for:!0,ref:l=>U[`${e}-${o}`]=l,maxLength:"1","data-row":e,"data-col":o,"data-correct":ee(e,o),"data-words":oe(e,o),style:h({backgroundColor:le(e,o)}),onInput:ue,onClick:l=>function(e,o){const l=JSON.parse(oe(e,o));if(0===l.length)return;Q.value.row!==e||Q.value.col!==o?Q.value={row:e,col:o,wordIndex:0}:Q.value.wordIndex=(Q.value.wordIndex+1)%l.length;const a=J.value.find((e=>e.number===l[Q.value.wordIndex].wordNumber));if(a){ne(a);const l=U[`${e}-${o}`];l&&l.select()}}(e,o)},null,44,I)],64)):v("",!0)],6)))),128))],64)))),128))],4),d("div",B,[d("ul",{id:"clue-list",style:h({display:q.value?"none":"block"})},[(c(!0),f(w,null,g(J.value,(e=>{return c(),f("li",{key:e.number,class:p({highlighted:(o=e.number,G.value===o)}),onClick:o=>ne(e),style:h({borderBottom:`2px solid ${e.color}`}),title:e.word},m(e.number)+". "+m(e.clue)+" ("+m("across"===e.direction?"Horizontal":"Vertical")+") ",15,M);var o})),128))],4)])]),q.value?(c(),f("div",S,[d("div",T,[o[5]||(o[5]=d("p",null,"Gerando palavras cruzadas...",-1)),d("p",null,"Tentativa "+m(H.value)+" de "+m(5),1)])])):v("",!0)])])),_:1},8,["loading","score"]))}},[["__scopeId","data-v-bb85d1fe"]]);export{E as default};
//# sourceMappingURL=CrosswordsGame-BxL3P6gm.js.map
