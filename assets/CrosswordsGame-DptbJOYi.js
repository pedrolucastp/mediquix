import{u as e}from"./SelectorsComponent-DJdB6c_8.js";import{u as o,G as r}from"./GameContainer-qHmNehOK.js";import{_ as a,r as l,x as t,c as n,a as s,d as u,f as c,e as i,g as d,h as f,i as v,n as h,F as p,j as w,k as g,t as m,p as y,B as b,q as k}from"./index-BYb6PZRb.js";const C={class:"crosswords-game"},x={id:"crossword-container"},$={key:0,class:"clue-number"},I=["id","data-row","data-col","data-correct","data-words","onClick"],B={id:"clues"},M=["onClick","title"],S={key:0,class:"loading-overlay"},T={class:"loading-message"},_=25,N=30,E=a({__name:"CrosswordsGame",setup(a){const{usePerk:E}=o(),F=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#ff24c0","#D4A5A5","#9B97B2","#FFB347","#87CEEB","#98FB98"],G=Math.floor(12.5),j=Math.floor(15),z=l([]),A=l([]),J=l(null),O=l("across"),P=l(new Set),R=l(new Set),D=l(null),U=t({}),H=l(!1),L=l(1),W=l(!1),q=l(0);l(!1),l(0);const V=e(),K=l(!0),Q=l({row:null,col:null,wordIndex:0}),X=n((()=>({gridTemplateColumns:"repeat(30, 40px)",gridTemplateRows:"repeat(25, 40px)"}))),Y=n((()=>Array.from({length:_},((e,o)=>o)))),Z=n((()=>Array.from({length:N},((e,o)=>o))));function ee(e,o){var r;return(null==(r=z.value[e])?void 0:r[o])||null}function oe(e,o){const r=A.value.filter((r=>r.positions.some((r=>r.row===e&&r.col===o))));return JSON.stringify(r.map((e=>({wordNumber:e.number,direction:e.direction}))))}function re(e,o){const r=A.value.filter((r=>r.positions.some((r=>r.row===e&&r.col===o))));return r.length>0?" "===ee(e,o)?"white":r[0].color+(function(e,o){return P.value.has(`${e}-${o}`)}(e,o)||function(e,o){return R.value.has(`${e}-${o}`)}(e,o)?"":"70"):"transparent"}function ae(e,o){const r=A.value.filter((r=>r.positions.some((r=>r.row===e&&r.col===o))));if(0===r.length)return{};const a={border:"1px solid var(--dark-border-color)",backgroundColor:"transparent"},l=r.find((e=>e.positions.some((e=>P.value.has(`${e.row}-${e.col}`)))));if(l){a.backgroundColor="rgba(255, 255, 0, 0.1)";const r=l.positions.findIndex((r=>r.row===e&&r.col===o)),t=0===r,n=r===l.positions.length-1;"across"===l.direction?(a.borderTop="3px solid darkgrey",a.borderBottom="3px solid darkgrey",t&&(a.borderLeft="3px solid darkgrey"),n&&(a.borderRight="3px solid darkgrey")):(a.borderLeft="3px solid darkgrey",a.borderRight="3px solid darkgrey",t&&(a.borderTop="3px solid darkgrey"),n&&(a.borderBottom="3px solid darkgrey"))}return a}function le(e,o){return A.value.some((r=>r.row===e&&r.col===o))}function te(e,o){const r=A.value.find((r=>r.row===e&&r.col===o));return null==r?void 0:r.number}function ne(e){se(),e.positions.forEach((e=>{P.value.add(`${e.row}-${e.col}`)})),D.value=e.number}function se(){P.value.clear(),R.value.clear(),D.value=null}function ue(e){const o=e.target,r=JSON.parse(o.dataset.words||"[]");if(r&&r.length>0&&(!J.value||!ce(o))){J.value=r[0],O.value=r[0].direction;const e=A.value.find((e=>e.number===r[0].wordNumber));e&&ne(e)}if(!e.data||""===o.value)return o.value="",void function(e){const o=parseInt(e.dataset.row),r=parseInt(e.dataset.col);if(!J.value||!O.value)return;let a=o,l=r;"across"===O.value?l--:a--;const t=U[`${a}-${l}`];t&&ce(t)&&(t.focus(),t.select())}(o);o.value=e.data.toUpperCase(),o.select(),function(e){const o=parseInt(e.dataset.row),r=parseInt(e.dataset.col);if(!J.value||!O.value)return;let a=o,l=r;"across"===O.value?l++:a++;const t=U[`${a}-${l}`];t&&ce(t)&&t.focus()}(o)}function ce(e){if(!J.value||!O.value)return!1;const o=JSON.parse(e.dataset.words||"[]");if(!o||0===o.length)return!1;const r=A.value.find((e=>e.number===J.value.wordNumber));if(!r)return!1;const a=parseInt(e.dataset.row),l=parseInt(e.dataset.col);return"across"===O.value?a===r.row&&l>=r.col&&l<r.col+r.word.length:l===r.col&&a>=r.row&&a<r.row+r.word.length}function ie(e,o,r,a){if("across"===a){if(r<0||r+e.length>N||o<0||o>=_)return!1;let a=!1;for(let n=0;n<e.length;n++){const l=z.value[o][r+n];if(l){if(l!==e[n])return!1;a=!0}const t=o>0?z.value[o-1][r+n]:null,s=o<24?z.value[o+1][r+n]:null;if(t&&!de(o-1,r+n)||s&&!de(o+1,r+n))return!1}const l=r>0?z.value[o][r-1]:null,t=r+e.length<N?z.value[o][r+e.length]:null;return!l&&!t&&(0===A.value.length||a)}if("down"===a){if(o<0||o+e.length>_||r<0||r>=N)return!1;let a=!1;for(let n=0;n<e.length;n++){const l=z.value[o+n][r];if(l){if(l!==e[n])return!1;a=!0}const t=r>0?z.value[o+n][r-1]:null,s=r<29?z.value[o+n][r+1]:null;if(t&&!de(o+n,r-1)||s&&!de(o+n,r+1))return!1}const l=o>0?z.value[o-1][r]:null,t=o+e.length<_?z.value[o+e.length][r]:null;return!l&&!t&&(0===A.value.length||a)}return!1}function de(e,o){return A.value.some((r=>"across"===r.direction?e===r.row&&o>=r.col&&o<r.col+r.word.length:"down"===r.direction&&(o===r.col&&e>=r.row&&e<r.row+r.word.length)))}async function fe(e,o,r,a,l=!0){const t=[];if("across"===a)for(let n=0;n<e.length;n++)null===z.value[o][r+n]&&(z.value[o][r+n]=l?"?":e[n],t.push({row:o,col:r+n}));else for(let n=0;n<e.length;n++)null===z.value[o+n][r]&&(z.value[o+n][r]=l?"?":e[n],t.push({row:o+n,col:r}));return l&&(await async function(e){return new Promise((o=>setTimeout(o,e)))}(20),t.forEach((e=>{"?"===z.value[e.row][e.col]&&(z.value[e.row][e.col]=null)}))),t}function ve(e,o,r,a){let l=0;if("across"===a)for(let t=0;t<e.length;t++)null!==z.value[o][r+t]&&z.value[o][r+t]===e[t]&&l++;else for(let t=0;t<e.length;t++)null!==z.value[o+t][r]&&z.value[o+t][r]===e[t]&&l++;return l}function he(e,o){const r=[];for(let a=0;a<_;a++)for(let l=0;l<N;l++)if(ie(e,a,l,o)){const t=ve(e,a,l,o);r.push({row:a,col:l,direction:o,intersections:t})}return r.sort(((e,o)=>o.intersections-e.intersections)),r}async function pe(e){for(;A.value.length<5;){let o=!1;const r=new Set;for(;!o&&r.size<e.length;){let a;do{a=Math.floor(Math.random()*e.length)}while(r.has(a));r.add(a);const l=e[a],t=[];for(const e of["across","down"]){const o=await he(l.word,e);t.push(...o)}if(t.length>0){t.sort(((e,o)=>o.intersections-e.intersections));const r=t.slice(0,Math.min(3,t.length)),n=r[Math.floor(Math.random()*r.length)];await fe(l.word,n.row,n.col,n.direction,!0);const s=await fe(l.word,n.row,n.col,n.direction,!1);if(s.length>0){A.value.push({word:l.word,clue:l.clue,row:n.row,col:n.col,direction:n.direction,positions:s,number:A.value.length+1,color:F[A.value.length%F.length]}),e.splice(a,1),o=!0;break}}}if(!o)return!1}return 5===A.value.length}async function we(e){if(L.value>5)return!1;!function(){z.value=[];for(let e=0;e<_;e++)z.value.push(new Array(N).fill(null));for(const e in U){const o=U[e];o&&(o.value="",o.style.backgroundColor="transparent",o.style.color="var(--text-color)")}A.value=[],se(),J.value=null,O.value="across",z.value.forEach((e=>e.fill(null)))}(),setTimeout((()=>function(){const e=document.getElementById("crossword");if(e){const o=(e.scrollWidth-e.clientWidth)/2,r=(e.scrollHeight-e.clientHeight)/2;e.scrollTo({left:o,top:r,behavior:"smooth"})}}()),100);const o=[...e],r=new Set;for(;r.size<o.length;){let e;do{e=Math.floor(Math.random()*o.length)}while(r.has(e));r.add(e);const a=o[e],l=await fe(a.word,G,Math.floor(j-a.word.length/2),"across",!1);if(l.length>0){A.value.push({word:a.word,clue:a.clue,row:G,col:Math.floor(j-a.word.length/2),direction:"across",positions:l,number:1,color:F[0]}),o.splice(e,1);if(await pe(o))return!0}}return L.value++,!1}async function ge(e=!1){if(e||K.value)try{H.value=!0,W.value=!0;const e=V.filteredWords;!(await we(e))&&L.value<5&&await ge(!0)}catch(o){}finally{H.value=!1,W.value=!1,se(),K.value=!1}}async function me(e){if(await E(e)&&"hint"===e){const e=Object.values(U).filter((e=>e&&""===e.value));if(e.length>0){const o=e[Math.floor(Math.random()*e.length)];o.value=o.dataset.correct,o.style.backgroundColor="#ffe066",setTimeout((()=>{o.style.backgroundColor=""}),1e3)}}}function ye(){for(const e in U){const o=U[e];o&&o.dataset.correct&&(o.value=o.dataset.correct,o.style.color="#FF0000")}q.value=0}return s((()=>{ge()})),(e,o)=>(i(),u(r,{title:"Palavras Cruzadas",gameInstructions:"Complete as palavras cruzadas usando as dicas fornecidas.\n- Clique em uma célula para selecionar uma palavra\n- Use as dicas para descobrir as palavras\n- Ganhe 2 pontos por cada palavra completada\n- Ganhe 10 pontos por completar o jogo\n- Ganhe 15 pontos de bônus por terminar sem erros\n- Use a dica (5 pts) para revelar uma letra aleatória\n- Todas as palavras estão relacionadas à especialidade médica selecionada",loading:W.value,score:q.value,availablePerks:["hint","extra_time","skip"],onSpecialtyChange:o[1]||(o[1]=e=>ge(!0)),onDifficultyChange:o[2]||(o[2]=e=>ge(!0)),onUsePerk:me},{"game-settings":c((()=>[y(b,{onClick:o[0]||(o[0]=e=>ge(!0))},{default:c((()=>o[3]||(o[3]=[k("Novo Jogo")]))),_:1}),y(b,{onClick:ye,variant:"accent"},{default:c((()=>o[4]||(o[4]=[k("Revelar Respostas")]))),_:1})])),default:c((()=>[d("div",C,[d("div",x,[d("div",{id:"crossword",style:h(X.value)},[(i(!0),f(p,null,w(Y.value,(e=>(i(),f(p,{key:e},[(i(!0),f(p,null,w(Z.value,(o=>(i(),f("div",{key:`${e}-${o}`,class:g(["cell",{empty:!ee(e,o)}]),style:h(ee(e,o)?ae(e,o):{})},[ee(e,o)?(i(),f(p,{key:0},[le(e,o)?(i(),f("span",$,m(te(e,o)),1)):v("",!0),d("input",{id:`cell-${e}-${o}`,ref_for:!0,ref:r=>U[`${e}-${o}`]=r,maxLength:"1","data-row":e,"data-col":o,"data-correct":ee(e,o),"data-words":oe(e,o),style:h({backgroundColor:re(e,o)}),onInput:ue,onClick:r=>function(e,o){const r=JSON.parse(oe(e,o));if(0===r.length)return;Q.value.row!==e||Q.value.col!==o?Q.value={row:e,col:o,wordIndex:0}:Q.value.wordIndex=(Q.value.wordIndex+1)%r.length;const a=A.value.find((e=>e.number===r[Q.value.wordIndex].wordNumber));if(a){ne(a);const r=U[`${e}-${o}`];r&&r.select()}}(e,o)},null,44,I)],64)):v("",!0)],6)))),128))],64)))),128))],4),d("div",B,[d("ul",{id:"clue-list",style:h({display:H.value?"none":"block"})},[(i(!0),f(p,null,w(A.value,(e=>{return i(),f("li",{key:e.number,class:g({highlighted:(o=e.number,D.value===o)}),onClick:o=>ne(e),style:h({borderBottom:`2px solid ${e.color}`}),title:e.word},m(e.number)+". "+m(e.clue)+" ("+m("across"===e.direction?"Horizontal":"Vertical")+") ",15,M);var o})),128))],4)])]),H.value?(i(),f("div",S,[d("div",T,[o[5]||(o[5]=d("p",null,"Gerando palavras cruzadas...",-1)),d("p",null,"Tentativa "+m(L.value)+" de "+m(5),1)])])):v("",!0)])])),_:1},8,["loading","score"]))}},[["__scopeId","data-v-c1576d77"]]);export{E as default};
//# sourceMappingURL=CrosswordsGame-DptbJOYi.js.map
