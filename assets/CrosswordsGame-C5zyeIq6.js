import{u as e}from"./SelectorsComponent-BHgr9fBZ.js";import{u as o,G as t}from"./GameContainer-DfY2muwH.js";import{_ as a,r,x as l,c as n,a as s,d as u,f as i,e as c,g as d,h as f,i as v,n as h,F as p,j as w,k as g,t as m,p as b,B as y,q as k}from"./index-Bfo6PRYR.js";import{u as x}from"./useGameState-VT9cnjiQ.js";const C={class:"crosswords-game"},$={id:"crossword-container"},I={key:0,class:"clue-number"},B=["id","data-row","data-col","data-correct","data-words","onClick"],M={id:"clues"},S=["onClick","title"],_={key:0,class:"loading-overlay"},G={class:"loading-message"},E=25,F=30,N=a({__name:"CrosswordsGame",setup(a){const{usePerk:N}=o(),{startGame:T,resetGame:j}=x(),z=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#ff24c0","#D4A5A5","#9B97B2","#FFB347","#87CEEB","#98FB98"],L=Math.floor(12.5),A=Math.floor(15),J=r([]),O=r([]),P=r(null),R=r("across"),D=r(new Set),U=r(new Set),W=r(null),H=l({}),q=r(!1),V=r(1),K=r(!1),Q=r(0);r(!1),r(0);const X=e(),Y=r(!0),Z=r({row:null,col:null,wordIndex:0}),ee=n((()=>({gridTemplateColumns:"repeat(30, 40px)",gridTemplateRows:"repeat(25, 40px)"}))),oe=n((()=>Array.from({length:E},((e,o)=>o)))),te=n((()=>Array.from({length:F},((e,o)=>o))));function ae(e,o){var t;return(null==(t=J.value[e])?void 0:t[o])||null}function re(e,o){const t=O.value.filter((t=>t.positions.some((t=>t.row===e&&t.col===o))));return JSON.stringify(t.map((e=>({wordNumber:e.number,direction:e.direction}))))}function le(e,o){const t=O.value.filter((t=>t.positions.some((t=>t.row===e&&t.col===o))));return t.length>0?" "===ae(e,o)?"white":t[0].color+(function(e,o){return D.value.has(`${e}-${o}`)}(e,o)||function(e,o){return U.value.has(`${e}-${o}`)}(e,o)?"":"70"):"transparent"}function ne(e,o){const t=O.value.filter((t=>t.positions.some((t=>t.row===e&&t.col===o))));if(0===t.length)return{};const a={border:"1px solid var(--dark-border-color)",backgroundColor:"transparent"},r=t.find((e=>e.positions.some((e=>D.value.has(`${e.row}-${e.col}`)))));if(r){a.backgroundColor="rgba(255, 255, 0, 0.1)";const t=r.positions.findIndex((t=>t.row===e&&t.col===o)),l=0===t,n=t===r.positions.length-1;"across"===r.direction?(a.borderTop="3px solid darkgrey",a.borderBottom="3px solid darkgrey",l&&(a.borderLeft="3px solid darkgrey"),n&&(a.borderRight="3px solid darkgrey")):(a.borderLeft="3px solid darkgrey",a.borderRight="3px solid darkgrey",l&&(a.borderTop="3px solid darkgrey"),n&&(a.borderBottom="3px solid darkgrey"))}return a}function se(e,o){return O.value.some((t=>t.row===e&&t.col===o))}function ue(e,o){const t=O.value.find((t=>t.row===e&&t.col===o));return null==t?void 0:t.number}function ie(e){ce(),e.positions.forEach((e=>{D.value.add(`${e.row}-${e.col}`)})),W.value=e.number}function ce(){D.value.clear(),U.value.clear(),W.value=null}function de(e){const o=e.target,t=JSON.parse(o.dataset.words||"[]");if(t&&t.length>0&&(!P.value||!fe(o))){P.value=t[0],R.value=t[0].direction;const e=O.value.find((e=>e.number===t[0].wordNumber));e&&ie(e)}if(!e.data||""===o.value)return o.value="",void function(e){const o=parseInt(e.dataset.row),t=parseInt(e.dataset.col);if(!P.value||!R.value)return;let a=o,r=t;"across"===R.value?r--:a--;const l=H[`${a}-${r}`];l&&fe(l)&&(l.focus(),l.select())}(o);o.value=e.data.toUpperCase(),o.select(),function(e){const o=parseInt(e.dataset.row),t=parseInt(e.dataset.col);if(!P.value||!R.value)return;let a=o,r=t;"across"===R.value?r++:a++;const l=H[`${a}-${r}`];l&&fe(l)&&l.focus()}(o)}function fe(e){if(!P.value||!R.value)return!1;const o=JSON.parse(e.dataset.words||"[]");if(!o||0===o.length)return!1;const t=O.value.find((e=>e.number===P.value.wordNumber));if(!t)return!1;const a=parseInt(e.dataset.row),r=parseInt(e.dataset.col);return"across"===R.value?a===t.row&&r>=t.col&&r<t.col+t.word.length:r===t.col&&a>=t.row&&a<t.row+t.word.length}function ve(e,o,t,a){if("across"===a){if(t<0||t+e.length>F||o<0||o>=E)return!1;let a=!1;for(let n=0;n<e.length;n++){const r=J.value[o][t+n];if(r){if(r!==e[n])return!1;a=!0}const l=o>0?J.value[o-1][t+n]:null,s=o<24?J.value[o+1][t+n]:null;if(l&&!he(o-1,t+n)||s&&!he(o+1,t+n))return!1}const r=t>0?J.value[o][t-1]:null,l=t+e.length<F?J.value[o][t+e.length]:null;return!r&&!l&&(0===O.value.length||a)}if("down"===a){if(o<0||o+e.length>E||t<0||t>=F)return!1;let a=!1;for(let n=0;n<e.length;n++){const r=J.value[o+n][t];if(r){if(r!==e[n])return!1;a=!0}const l=t>0?J.value[o+n][t-1]:null,s=t<29?J.value[o+n][t+1]:null;if(l&&!he(o+n,t-1)||s&&!he(o+n,t+1))return!1}const r=o>0?J.value[o-1][t]:null,l=o+e.length<E?J.value[o+e.length][t]:null;return!r&&!l&&(0===O.value.length||a)}return!1}function he(e,o){return O.value.some((t=>"across"===t.direction?e===t.row&&o>=t.col&&o<t.col+t.word.length:"down"===t.direction&&(o===t.col&&e>=t.row&&e<t.row+t.word.length)))}async function pe(e,o,t,a,r=!0){const l=[];if("across"===a)for(let n=0;n<e.length;n++)null===J.value[o][t+n]&&(J.value[o][t+n]=r?"?":e[n],l.push({row:o,col:t+n}));else for(let n=0;n<e.length;n++)null===J.value[o+n][t]&&(J.value[o+n][t]=r?"?":e[n],l.push({row:o+n,col:t}));return r&&(await async function(e){return new Promise((o=>setTimeout(o,e)))}(20),l.forEach((e=>{"?"===J.value[e.row][e.col]&&(J.value[e.row][e.col]=null)}))),l}function we(e,o,t,a){let r=0;if("across"===a)for(let l=0;l<e.length;l++)null!==J.value[o][t+l]&&J.value[o][t+l]===e[l]&&r++;else for(let l=0;l<e.length;l++)null!==J.value[o+l][t]&&J.value[o+l][t]===e[l]&&r++;return r}function ge(e,o){const t=[];for(let a=0;a<E;a++)for(let r=0;r<F;r++)if(ve(e,a,r,o)){const l=we(e,a,r,o);t.push({row:a,col:r,direction:o,intersections:l})}return t.sort(((e,o)=>o.intersections-e.intersections)),t}async function me(e){for(;O.value.length<5;){let o=!1;const t=new Set;for(;!o&&t.size<e.length;){let a;do{a=Math.floor(Math.random()*e.length)}while(t.has(a));t.add(a);const r=e[a],l=[];for(const e of["across","down"]){const o=await ge(r.word,e);l.push(...o)}if(l.length>0){l.sort(((e,o)=>o.intersections-e.intersections));const t=l.slice(0,Math.min(3,l.length)),n=t[Math.floor(Math.random()*t.length)];await pe(r.word,n.row,n.col,n.direction,!0);const s=await pe(r.word,n.row,n.col,n.direction,!1);if(s.length>0){O.value.push({word:r.word,clue:r.clue,row:n.row,col:n.col,direction:n.direction,positions:s,number:O.value.length+1,color:z[O.value.length%z.length]}),e.splice(a,1),o=!0;break}}}if(!o)return!1}return 5===O.value.length}async function be(e){if(V.value>5)return!1;!function(){J.value=[];for(let e=0;e<E;e++)J.value.push(new Array(F).fill(null));for(const e in H){const o=H[e];o&&(o.value="",o.style.backgroundColor="transparent",o.style.color="var(--text-color)")}O.value=[],ce(),P.value=null,R.value="across",J.value.forEach((e=>e.fill(null)))}(),setTimeout((()=>function(){const e=document.getElementById("crossword");if(e){const o=(e.scrollWidth-e.clientWidth)/2,t=(e.scrollHeight-e.clientHeight)/2;e.scrollTo({left:o,top:t,behavior:"smooth"})}}()),100);const o=[...e],t=new Set;for(;t.size<o.length;){let e;do{e=Math.floor(Math.random()*o.length)}while(t.has(e));t.add(e);const a=o[e],r=await pe(a.word,L,Math.floor(A-a.word.length/2),"across",!1);if(r.length>0){O.value.push({word:a.word,clue:a.clue,row:L,col:Math.floor(A-a.word.length/2),direction:"across",positions:r,number:1,color:z[0]}),o.splice(e,1);if(await me(o))return!0}}return V.value++,!1}async function ye(e=!1){j(),K.value=!0,q.value=!0;try{if(!T())throw new Error("Failed to initialize game state");const e=X.filteredWords;!(await be(e))&&V.value<5&&await ye(!0)}catch(o){}finally{q.value=!1,K.value=!1,ce(),Y.value=!1}}async function ke(e){if(await N(e))if("hint"===e){const e=Object.values(H).filter((e=>e&&""===e.value&&e.dataset.letter));if(e.length>0){const o=e[Math.floor(Math.random()*e.length)],t=o.dataset.letter;o.value=t,o.classList.add("revealed"),checkWord(o)}}else"skip"===e?await ye(!0):"extra_time"===e&&"undefined"!=typeof timeLeft&&timeLeft&&(timeLeft.value+=30)}function xe(){for(const e in H){const o=H[e];o&&o.dataset.correct&&(o.value=o.dataset.correct,o.style.color="#FF0000")}Q.value=0}return s((()=>{ye()})),(e,o)=>(c(),u(t,{title:"Palavras Cruzadas",gameInstructions:"Complete as palavras cruzadas usando as dicas fornecidas.\n- Clique em uma célula para selecionar uma palavra\n- Use as dicas para descobrir as palavras\n- Ganhe 2 pontos por cada palavra completada\n- Ganhe 10 pontos por completar o jogo\n- Ganhe 15 pontos de bônus por terminar sem erros\n- Use a dica (5 pts) para revelar uma letra aleatória\n- Todas as palavras estão relacionadas à especialidade médica selecionada",loading:K.value,score:Q.value,availablePerks:["hint","extra_time","skip"],onSpecialtyChange:o[1]||(o[1]=e=>ye(!0)),onDifficultyChange:o[2]||(o[2]=e=>ye(!0)),onUsePerk:ke},{"game-settings":i((()=>[b(y,{onClick:o[0]||(o[0]=e=>ye(!0))},{default:i((()=>o[3]||(o[3]=[k("Novo Jogo")]))),_:1}),b(y,{onClick:xe,variant:"accent"},{default:i((()=>o[4]||(o[4]=[k("Revelar Respostas")]))),_:1})])),default:i((()=>[d("div",C,[d("div",$,[d("div",{id:"crossword",style:h(ee.value)},[(c(!0),f(p,null,w(oe.value,(e=>(c(),f(p,{key:e},[(c(!0),f(p,null,w(te.value,(o=>(c(),f("div",{key:`${e}-${o}`,class:g(["cell",{empty:!ae(e,o)}]),style:h(ae(e,o)?ne(e,o):{})},[ae(e,o)?(c(),f(p,{key:0},[se(e,o)?(c(),f("span",I,m(ue(e,o)),1)):v("",!0),d("input",{id:`cell-${e}-${o}`,ref_for:!0,ref:t=>H[`${e}-${o}`]=t,maxLength:"1","data-row":e,"data-col":o,"data-correct":ae(e,o),"data-words":re(e,o),style:h({backgroundColor:le(e,o)}),onInput:de,onClick:t=>function(e,o){const t=JSON.parse(re(e,o));if(0===t.length)return;Z.value.row!==e||Z.value.col!==o?Z.value={row:e,col:o,wordIndex:0}:Z.value.wordIndex=(Z.value.wordIndex+1)%t.length;const a=O.value.find((e=>e.number===t[Z.value.wordIndex].wordNumber));if(a){ie(a);const t=H[`${e}-${o}`];t&&t.select()}}(e,o)},null,44,B)],64)):v("",!0)],6)))),128))],64)))),128))],4),d("div",M,[d("ul",{id:"clue-list",style:h({display:q.value?"none":"block"})},[(c(!0),f(p,null,w(O.value,(e=>{return c(),f("li",{key:e.number,class:g({highlighted:(o=e.number,W.value===o)}),onClick:o=>ie(e),style:h({borderBottom:`2px solid ${e.color}`}),title:e.word},m(e.number)+". "+m(e.clue)+" ("+m("across"===e.direction?"Horizontal":"Vertical")+") ",15,S);var o})),128))],4)])]),q.value?(c(),f("div",_,[d("div",G,[o[5]||(o[5]=d("p",null,"Gerando palavras cruzadas...",-1)),d("p",null,"Tentativa "+m(V.value)+" de "+m(5),1)])])):v("",!0)])])),_:1},8,["loading","score"]))}},[["__scopeId","data-v-b5bc56bc"]]);export{N as default};
//# sourceMappingURL=CrosswordsGame-C5zyeIq6.js.map
